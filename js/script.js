(function(){var e=[].indexOf||function(e){for(var n=0,t=this.length;t>n;n++)if(n in this&&this[n]===e)return n;return-1};$(function(){"use strict";var n,t,a,i,o;return $.fn.lazyLoad=function(){return this.each(function(){var e;return e=$(this).attr("data-src"),"undefined"!==e&&e!==!1&&$(this).attr("src",e),$(this).on("load",function(){return $(this).transition({opacity:1},800,function(){return $(this).parent().removeClass("imgLoading"),$(this).attr("src",$(this).attr("src")+"?"+(new Date).getTime())})})})},$.fn.imgResize=function(e){var n,t,a,i,o,s,r,u,c,d,l,f;return e=$.extend({parent:$(this).parent()},e),u=$(e.parent).width(),r=$(e.parent).height(),t=$(this),s=t.width(),a=t.height(),d=u/s,c=r/a,n=Math.max(d,c),f=Math.floor(s*n),l=Math.floor(a*n),o=Math.floor((l-r)/-2),i=Math.floor((f-u)/-2),t.css({width:f,height:l,top:o,left:i})},$.fn.boxResize=function(e){var n,t,a,i;return e=$.extend({parent:$(this).parent(),scaleWidth:1,scaleHeight:1},e),t=$(e.parent).width(),n=$(e.parent).height(),i=e.scaleWidth,a=e.scaleHeight,$(this).css({width:t*i,height:n*a})},$.fn.backTop=function(){return this.click(function(){return $("html, body").stop().animate({scrollTop:0},1e3,"easeInOutCubic")})},o=function(){var a,o;return o=$("#js-progressbar"),$.preload({forward:$.pjax.follow,check:$.pjax.getCache,encode:!0,ajax:{xhr:function(){var n;return n=$.ajaxSettings.xhr(),n instanceof Object&&e.call(n,"onprogress")>=0&&(n.addEventListener("progress",function(e){var n,n=e.total?e.loaded/e.total:.4;return n=90*n+5,o.css({width:n+"%"})},!1),n.addEventListener("load",function(){return o.css({width:"95%"})},!1),n.addEventListener("error",function(){return o.css({"background-color":"#00f"})},!1)),n},success:function(e,n,t){return!$.pjax.getCache(this.url)&&$.pjax.setCache(this.url,null,n,t)},done:function(e,n,t){return!$.pjax.getCache(this.url)&&$.pjax.setCache(this.url,null,n,t),console.log("preload done")}}}),$.pjax({area:"#js-pjaxArea",wait:0,cache:{click:!0,submit:!1,popstate:!0},server:{query:null},speedcheck:!0,fallback:!1,ajax:{timeout:3e3},callbacks:{before:function(){return o.css({width:""}),o.show()},update:{content:{after:function(){return o.css({width:"40%"})}},css:{after:function(){return o.css({width:"60%"})}},script:{after:function(){return o.css({width:"80%"})}},render:{after:function(){return o.css({width:"100%"}),o.fadeOut()}}}}}),a=$("#js-loader"),$(document).on("pjax.request",function(){return clearTimeout($.data(a.get(0),"pjax-effect-id")),$.data(a.get(0),"pjax-effect-id",setTimeout(function(){return a.fadeIn(100)},1e3))}),$(document).on("pjax.render",function(){return clearTimeout($.data(a.get(0),"pjax-effect-id")),a.fadeOut(500),$.data(a.get(0),"pjax-effect-id",0)}),$(document).on("pjax.rady",function(){return $(document).trigger("preload")}),$(document).on("pjax.request",function(){return console.log("1 ajaxリクエスト送信前")}),$(window).on("pjax.unload",function(){return console.log("2 ajaxリクエスト更新前"),$(window).off("load"),$(window).off("resize"),$(document).off("imagesLoades",$("#js-mainvisual-image"))}),$(document).on("pjax.DOMContentLoaded",function(){var e;return console.log("3 すべての更新範囲更新後"),e=$("#js-pjaxArea").attr("data-pageclass"),$("body").removeClass().addClass(e),null!==document.getElementById("js-mainvisual")&&$("body").hasClass("page-index")?$("#js-mainvisual").boxResize({parent:$(window),scaleHeight:1}):void 0}),$(document).on("pjax.render",function(){return console.log("4 すべての更新範囲描画後"),$(window).on("resize",function(){return $("body").hasClass("page-index")?i():n()}),null!==document.getElementById("js-mainvisual")?$("#js-mainvisual-image").imagesLoaded().done(function(){return t(),$("body").hasClass("page-index")?(i(),console.log("now:index")):(n(),console.log("now:other"))}):void 0})},a=function(){return $(".navigation-toggle").on("click",function(){return $("body").toggleClass("is-nav-open")}),$(".l-global-nav a, .l-wrapper").on("click",function(){return $("body").hasClass("is-nav-open")?$("body").removeClass("is-nav-open"):void 0})},n=function(){return $("#js-mainvisual-image img").imgResize(),console.log("common mainvisual resized")},t=function(){return $("#js-mainvisual-image").transition({opacity:1,visibility:"visible"},800),$("#js-mainvisual").addClass("is-loaded")},i=function(){return $("#js-mainvisual").boxResize({parent:$(window),scaleHeight:1}),$("#js-mainvisual-image img").imgResize(),console.log("index mainvisual resized")},o(),$("#js-backtop").backTop(),a(),null!==document.getElementById("js-mainvisual")&&$("body").hasClass("page-index")&&$("#js-mainvisual").boxResize({parent:$(window),scaleHeight:1}),null!==document.getElementById("js-mainvisual")&&$("#js-mainvisual-image").imagesLoaded().done(function(){return $("body").hasClass("page-index")?i():n(),t()}),$(window).on("resize",function(){return $("body").hasClass("page-index")?i():n()})})}).call(this);