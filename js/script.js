(function(){var e=[].indexOf||function(e){for(var n=0,s=this.length;s>n;n++)if(n in this&&this[n]===e)return n;return-1};$(function(){"use strict";var n,s,t,o,a,i,r,l;return r=!/touch|tablet|mobile|phone|android|iphone|ipad|blackberry/i.test(window.navigator.userAgent),$.fn.lazyLoad=function(){return this.each(function(){var e;return e=$(this).attr("data-src"),"undefined"!==e&&e!==!1&&$(this).attr("src",e),$(this).on("load",function(){return $(this).transition({opacity:1},800,function(){return $(this).parent().removeClass("imgLoading"),$(this).attr("src",$(this).attr("src")+"?"+(new Date).getTime())})})})},$.fn.imgResize=function(e){var n,s,t,o,a,i,r,l,d,c,u,h;return e=$.extend({parent:$(this).parent()},e),l=$(e.parent).width(),r=$(e.parent).height(),s=$(this),i=s.width(),t=s.height(),c=l/i,d=r/t,n=Math.max(c,d),h=Math.floor(i*n),u=Math.floor(t*n),a=Math.floor((u-r)/-2),o=Math.floor((h-l)/-2),s.css({width:h,height:u,top:a,left:o})},$.fn.boxResize=function(e){var n,s,t,o;return e=$.extend({parent:$(this).parent(),scaleWidth:1,scaleHeight:1},e),s=$(e.parent).width(),n=$(e.parent).height(),o=e.scaleWidth,t=e.scaleHeight,$(this).css({width:s*o,height:n*t})},$.fn.backTop=function(){return this.click(function(){return $("html, body").stop().animate({scrollTop:0},1e3,"easeInOutCubic")})},l=function(){var o;return o=$("#js-progressbar"),r&&$.preload({forward:$.pjax.follow,check:$.pjax.getCache,encode:!0,ajax:{xhr:function(){var n;return n=$.ajaxSettings.xhr(),n instanceof Object&&e.call(n,"onprogress")>=0&&(n.addEventListener("progress",function(e){var n,n=e.total?e.loaded/e.total:.4;return n=90*n+5,o.css({width:n+"%"})},!1),n.addEventListener("load",function(){return o.css({width:"95%"})},!1),n.addEventListener("error",function(){return o.css({"background-color":"#00f"})},!1)),n},success:function(e,n,s){return!$.pjax.getCache(this.url)&&$.pjax.setCache(this.url,null,n,s)},done:function(e,n,s){return!$.pjax.getCache(this.url)&&$.pjax.setCache(this.url,null,n,s),console.log("preload done")}}}),$.pjax({area:"#js-pjaxArea",wait:0,cache:{click:!0,submit:!1,popstate:!0},server:{query:null},speedcheck:!0,fallback:!1,ajax:{timeout:3e3},callbacks:{update:{content:{after:function(){return o.css({width:"40%"}),console.log("content loaded")}},css:{after:function(){return o.css({width:"60%"}),console.log("css loaded")}},script:{after:function(){return o.css({width:"80%"}),console.log("script loaded")}}}}}),$(document).on("pjax:fetch",function(){return o.css({width:""}),console.log("1 データ取得処理前"),o.removeClass("is-hidden"),console.log("progressbar show")}),$(window).on("pjax:unload",function(){return console.log("2 データの取得後、ページの更新前"),$(window).off("load"),$(window).off("resize"),$(document).off("imagesLoades",$("#js-mainvisual-image"))}),$(document).on("pjax:DOMContentLoaded",function(){var e;return console.log("3 すべての範囲のDOMの更新後(CSSの更新とScriptの実行は未完了)"),e=$("#js-pjaxArea").attr("data-pageclass"),$("body").removeClass().addClass(e),null!==document.getElementById("js-mainvisual")&&$("body").hasClass("page-index")?$("#js-mainvisual").boxResize({parent:$(window),scaleHeight:1}):void 0}),$(document).on("pjax:ready",function(){return $(document).trigger("preload"),console.log("4 すべてのDOMの更新後")}),$(document).on("pjax:render",function(){return console.log("5 すべての更新範囲の描画後"),$("body").hasClass("page-single")&&(n(),console.log("GoogleCodePrettify done")),o.css({width:"100%"}),setTimeout(function(){return o.addClass("is-hidden")},300),console.log("progressbar hide"),$(window).on("resize",function(){return $("body").hasClass("page-index")||$("body").hasClass("single-works")?(i(),a()):s()}),null!==document.getElementById("js-mainvisual")?(($("body").hasClass("page-index")||$("body").hasClass("single-works"))&&i(),$("#js-mainvisual-image").imagesLoaded().done(function(){return t(),$("body").hasClass("page-index")||$("body").hasClass("single-works")?(a(),console.log("now:index")):(s(),console.log("now:other"))})):void 0}),$(window).on("pjax:load",function(){return console.log("6 すべての画像とフレームの読み込み後")})},o=function(){var e;return e=e=r?"click":"touchstart",$("#js-navigation-toggle").on(e,function(){return $("body").toggleClass("is-nav-open")}),$("#js-navigation a").on("click",function(){return $("body").removeClass("is-nav-open")}),$("#js-overlay").on(e,function(){return $("body").hasClass("is-nav-open")?$("body").removeClass("is-nav-open"):void 0})},s=function(){return $("#js-mainvisual-image img").imgResize(),console.log("common mainvisual resized")},t=function(){return $("#js-mainvisual-image").removeClass("is-hidden"),$("#js-mainvisual-text").delay(1e3).queue(function(){return $(this).removeClass("is-hidden").dequeue()}),$("#js-mainvisual").addClass("is-loaded")},n=function(){return $("pre").addClass("prettyprint"),prettyPrint()},i=function(){return $("#js-mainvisual").boxResize({parent:$(window),scaleHeight:1}),console.log("index mainvisual area resized")},a=function(){return $("#js-mainvisual-image img").imgResize(),console.log("index mainvisual image resized")},l(),$("#js-contentloader").addClass("is-hidden"),$("#js-backtop").backTop(),o(),n(),null!==document.getElementById("js-mainvisual")&&($("body").hasClass("page-index")||$("body").hasClass("single-works"))&&$("#js-mainvisual").boxResize({parent:$(window),scaleHeight:1}),null!==document.getElementById("js-mainvisual")&&$("#js-mainvisual-image").imagesLoaded().done(function(){return $("body").hasClass("page-index")||$("body").hasClass("single-works")?(i(),a()):s(),t()}),null!==document.getElementById("js-mainvisual")?$(window).on("resize",function(){return $("body").hasClass("page-index")||$("body").hasClass("single-works")?(i(),a()):s()}):void 0})}).call(this);